---
title: monorepo + rushjs 加快编译速度
date: Thu Sep 23 2021 08:00:00 GMT+0800 (中国标准时间)
status: draft
---
手上的项目接入 rushjs + pnpm 已经有一段时间了，最初的一段时间一直忙于解决幽灵依赖导致引用依赖的版本的不稳定性。随着各个内外部幽灵依赖被逐个拎出来，各项目依赖性趋于稳定，项目终于从“难用”过渡到“能用”阶段。

然后我开始动手解决一个诟病已久的问题：

代码打包时间太 TMD 的久了！！！

代码打包速度两大步骤：

* npm install

* npm run build

这个问题放在普通项目中优化空间可能并不大，但在 monorepo 中却大有可为。

## pnpm filter

众所周知 pnpm 在 install 依赖方面已经做了非常大的优化，尤其是在二次安装同版本依赖